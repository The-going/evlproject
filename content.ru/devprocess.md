# Процесс разработки Xenomai 4 {#devprocess-xenomai4}

Проект Xenomai 4 работает над тремя программными компонентами:

- Интерфейс [Ласточкин хвост]({{< relref "dovetail/_index.md" >}}) который
вводит этап выполнения с высоким приоритетом в логику ядра Linux, на котором
функционально независимое сопутствующее программное ядро может получать
прерывания и запускать потоки.

- Компактное и SMP-масштабируемое ядро реального времени, также известное как
  [ядро EVL]({{< relref "core/_index.md" >}}), использующее возможности
  Ласточкиного хвоста, которое предназначено для эталонной реализации для других
  вспомогательных ядер на основе Dovetail. Таким образом, кодовая база Dovetail
  развивается настолько, насколько ядро EVL работает в самых последних выпусках
  ядра, и использует этот интерфейс, выявляя проблемы. Ядро EVL находится в
  пространстве ядра в качестве дополнительного компонента ядра Linux.

- Библиотека с именем [libevl]({{< relref "core/user-api/_index.md" >}}),
  которая реализует
  [интерфейс системных вызовов]({{< relref "core/user-api/function_index/_index.md" >}})
  между приложениями, запущенными в пользовательском пространстве, и
  [ядром EVL]({{< relref "core/_index.md" >}}), наряду с несколькими другими
  базовыми службами, [утилитами]({{< relref "core/commands.md" >}}) и
  [тестами на работоспособность]({{< relref "core/testing.md" >}}).

В том, как в настоящее время поддерживается код, рассматриваются следующие аспекты:

- Мы хотим отслеживать последний код магистрального ядра настолько внимательно,
  насколько это имеет смысл, одновременно решая проблему разработки кода вне дерева
  с точки зрения ядра магистрали.

- Код [Dovetail]({{< relref "dovetail/_index.md" >}}) должен быть доступен для
  других проектов для их собственного использования, на основе выпусков эталонного
  (магистрального) ядра.

- Поддержание ядра EVL (и Dovetail) поверх многочисленных выпусков ядра должно
  оставаться легко разрешаемой проблемой.

## Ядро EVL развитие и выпуски

Ядро EVL поддерживается в следующем репозитории GIT:

  * git@git.xenomai.org:Xenomai/xenomai4/linux-evl.git
  * https://git.xenomai.org/xenomai4/linux-evl.git

Это хранилище отслеживает дерево ядра
[Dovetail](https://git.xenomai.org/linux-dovetail.git),
которое, в свою очередь, отслеживает
[основное ядро](git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux-2.6.git).
Подробная информация о текущей политике заключается в следующем:

- поскольку ядро EVL всегда основано на порте "Ласточкин хвост" для основной
  версии ядра, каждая ветвь EVL изначально основана на ветви
  [Dovetail](https://git.xenomai.org/linux-dovetail.git). Например
  [v5.10.y-evl-rebase](https://git.xenomai.org/xenomai4/linux-evl/-/tree/v5.10.y-evl-rebase)
  в [дереве EVL](https://git.xenomai.org/xenomai4/linux-evl.git) происходит от
  [v5.10.y-dovetail-rebase](https://git.xenomai.org/linux-dovetail/-/tree/v5.10.y-dovetail-rebase)
  в [дереве Dovetail](https://git.xenomai.org/linux-dovetail.git).

- содержимое ветвей `*-rebase` может быть перебазировано без предварительного
  уведомления, так что коммиты, связанные с Dovetail и EVL , всегда отображаются
  поверх основного кода ванильного ядра. Все ветви EVL в настоящее время
  предназначены для перебазирования, у нас еще нет ветви слияния.

- Теги выпуска EVL имеют вид:

  - `v<kversion>-evl<serial>-rebase` при добавлении в ветвь перебазирования.
  - `v<kversion>-evl<serial>` при добавлении в ветвь слияния.

## Библиотека libevl развитие и выпуски {#libevl-release}

Строго линейный рабочий процесс разработки
[libevl]({{< relref "core/user-api/_index.md" >}}) проще по сравнению с ядром EVL.
В [дереве GIT libevl](https://git.xenomai.org/xenomai4/libevl.git/) есть одна
ветвь [master](https://git.xenomai.org/xenomai4/libevl/-/tree/master), в которой
происходит разработка. Со временем релизы `libevl` помечаются из произвольных
коммитов в этой ветке. Эти теги выглядят как  _r\<serial\>_, при этом серийный
номер увеличивается до бесконечности по мере выхода последующих выпусков.

![Alt text](/images/libevl-release-tags.png "libevl release tags")

Новый релиз [libevl](https://git.xenomai.org/xenomai4/libevl.git) может быть
помечен всякий раз, когда происходит одно из следующих событий:

- [ABI]({{< relref "core/under-the-hood/abi.md" >}}) , экспортируемый ядром EVL,
  изменился таким образом, что он не совместим с последней версией "libevl".
  Другими словами,
  [EVL_ABI_PREREQ](https://git.xenomai.org/xenomai4/libevl/-/blob/d12db5d2688ca3aa06a738a924171ef5fe85c6ab/include/evl/evl.h#L25)
  в некотором выпуске
  [libevl](https://git.xenomai.org/xenomai4/libevl/-/blob/d12db5d2688ca3aa06a738a924171ef5fe85c6ab/include/evl/evl.h#L25)
  больше не находится в диапазоне, определенном
  [\[EVL_ABI_BASE..EVL_ABI_LEVEL\]](https://git.xenomai.org/xenomai4/linux-evl/-/blob/37f57d73123c3b05b9b4f11d5cd3aa2768010dee/include/uapi/evl/control.h#L14).

- API, реализуемый `libevl` , изменяется, как правило, из-за добавления новых
  служб или изменений в сигнатуре существующих процедур. Это должно происходить
  редко, поскольку `libevl` предназначен только для предоставления небольшого
  набора базовых услуг, экспортируемых ядром EVL. Версия API, реализованная
  `libevl`, представляет собой целое число, которое присваивается  макроопределению C
  [\_\_EVL\_\_](https://git.xenomai.org/xenomai4/libevl/-/blob/d12db5d2688ca3aa06a738a924171ef5fe85c6ab/include/evl/evl.h#L23).
  Эту информацию также можно получить во время выполнения, вызвав процедуру
  [evl_get_version()]({{< relref "core/user-api/misc/_index.md#evl_get_version" >}}).

В любом случае, нет строгой взаимосвязи между данным тегом
[EVL core release]({{< relref "#lts-core-release" >}}) и тегом
[libevl release]({{< relref "#libevl-release" >}}). Конкретный выпуск `libevl`
может использоваться с несколькими последующими выпусками ядра EVL и, наоборот,
при условии соблюдения [требований ABI]({{< relref "core/under-the-hood/abi.md" >}}).

---

{{<lastmodified>}}
