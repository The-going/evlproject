<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.88.1" />
    <link rel="alternate" type="application/rss+xml" href="https://the-going.github.io/evlproject/core/user-api/poll/index.xml" title="Xenomai 4" />
    <meta name="description" content="Xenomai 4 project">
    <meta name="author" content="Philippe Gerum &lt;rpm@xenomai.org&gt;">
    <link rel="icon" href="https://the-going.github.io/evlproject/images/favicon.png" type="image/png">
    <title>Polling file descriptors :: Xenomai 4</title>
    <link href="https://the-going.github.io/evlproject/css/nucleus.css?1634415569" rel="stylesheet">
    <link href="https://the-going.github.io/evlproject/css/fontawesome-all.min.css?1634415569" rel="stylesheet">
    <link href="https://the-going.github.io/evlproject/css/featherlight.min.css?1634415569" rel="stylesheet">
    <link href="https://the-going.github.io/evlproject/css/perfect-scrollbar.min.css?1634415569" rel="stylesheet">
    <link href="https://the-going.github.io/evlproject/css/auto-complete.css?1634415569" rel="stylesheet">
    <link href="https://the-going.github.io/evlproject/css/theme.css?1634415569" rel="stylesheet">
    <link href="https://the-going.github.io/evlproject/css/theme-evl.css?1634415569" rel="stylesheet">
    <link href="https://the-going.github.io/evlproject/css/variant.css?1634415569" rel="stylesheet">
    <link href="https://the-going.github.io/evlproject/css/print.css?1634415569" rel="stylesheet" media="print">
    <script src="https://the-going.github.io/evlproject/js/jquery.min.js?1634415569"></script>
    <style>
      :root #header + #content > #left > #rlblock_left{
        display:none !important;
      }
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
    </style>
  </head>
  <body class="" data-url="https://the-going.github.io/evlproject/core/user-api/poll/">
    <nav id="sidebar" class="showVisitedLinks">
      <div id="header-wrapper">
        <div id="header">
<a href="https://the-going.github.io/evlproject/"><img src="https://the-going.github.io/evlproject/images/xenomai-logo.png"></a>

        </div>
        <div class="searchbox">
          <label for="search-by"><i class="fas fa-search"></i></label>
          <input data-search-input id="search-by" type="search" placeholder="Search...">
          <span data-search-clear=""><i class="fas fa-times"></i></span>
        </div>
        <script src="https://the-going.github.io/evlproject/js/lunr.min.js?1634415569"></script>
        <script src="https://the-going.github.io/evlproject/js/auto-complete.js?1634415569"></script>
        <!-- hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic: -->
        <!-- https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72 -->
        <script>
          var index_url="https://the-going.github.io/evlproject/index.json";
          var root_url="https://the-going.github.io/evlproject/";
          var baseUri=root_url.replace(/\/$/, '');
        </script>
        <script src="https://the-going.github.io/evlproject/js/search.js?1634415569"></script>
      </div>
      <div class="highlightable">
        <ul class="topics">
          <li data-nav-id="/overview/" title="Overview" class="dd-item"><a href="https://the-going.github.io/evlproject/overview/">&#8226; Get Started<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/" title="The EVL core" class="dd-item parent"><a href="https://the-going.github.io/evlproject/core/">&#8226; Real-time core<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/core/build-steps/" title="Building EVL" class="dd-item"><a href="https://the-going.github.io/evlproject/core/build-steps/">Building EVL<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/core/runtime-settings/" title="Runtime configuration" class="dd-item"><a href="https://the-going.github.io/evlproject/core/runtime-settings/">Runtime settings<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/core/testing/" title="Testing the installation" class="dd-item"><a href="https://the-going.github.io/evlproject/core/testing/">Running tests<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/core/commands/" title="The &#39;evl&#39; command" class="dd-item"><a href="https://the-going.github.io/evlproject/core/commands/">Commands<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/core/benchmarks/" title="Running benchmarks" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/benchmarks/">Benchmarking<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/caveat/" title="Things you definitely want to know" class="dd-item"><a href="https://the-going.github.io/evlproject/core/caveat/">Caveat<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/core/user-api/" title="Using libevl" class="dd-item parent alwaysopen"><a href="https://the-going.github.io/evlproject/core/user-api/">&#9702; Application interface<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/core/user-api/function_index/" title="libevl function index" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/user-api/function_index/">Function index<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/user-api/mutex/" title="Mutex" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/user-api/mutex/">Mutex<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/user-api/semaphore/" title="Semaphore" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/user-api/semaphore/">Semaphore<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/user-api/observable/" title="Observable" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/user-api/observable/">Observable<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/user-api/proxy/" title="File proxy" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/user-api/proxy/">File proxy<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/user-api/poll/" title="Polling file descriptors" class="dd-item active parent alwaysopen"><a href="https://the-going.github.io/evlproject/core/user-api/poll/">Polling file descriptors<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/user-api/io/" title="Out-of-band I/O services" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/user-api/io/">Out-of-band I/O services<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/user-api/misc/" title="Miscellanea" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/user-api/misc/">Misc. services<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/user-api/api-revs/" title="API revisions" class="dd-item"><a href="https://the-going.github.io/evlproject/core/user-api/api-revs/">API revisions<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/core/oob-drivers/" title="Real-time I/O drivers" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/oob-drivers/">&#9702; Real-time I/O drivers<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/core/oob-drivers/dma/" title="DMA" class="dd-item"><a href="https://the-going.github.io/evlproject/core/oob-drivers/dma/">DMA<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/core/oob-drivers/spi/" title="SPI" class="dd-item"><a href="https://the-going.github.io/evlproject/core/oob-drivers/spi/">SPI<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/core/oob-drivers/gpio/" title="GPIO" class="dd-item"><a href="https://the-going.github.io/evlproject/core/oob-drivers/gpio/">GPIO<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/core/kernel-api/" title="Writing drivers" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/">&#9702; Writing drivers<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/core/kernel-api/function_index/" title="Kernel function index" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/function_index/">Function index<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/kernel-api/file/" title="File description" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/file/">File description<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/kernel-api/socket/" title="Socket interface" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/socket/">Socket interface<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/kernel-api/kthread/" title="Kernel thread" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/kthread/">Kernel thread<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/kernel-api/wait/" title="Wait queue" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/wait/">Wait queue<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/kernel-api/mutex/" title="Kernel mutex" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/mutex/">Kernel mutex<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/kernel-api/semaphore/" title="Kernel semaphore" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/semaphore/">Kernel semaphore<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/kernel-api/flag/" title="Kernel flag" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/flag/">Kernel flag<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/kernel-api/spinlock/" title="EVL Spinlock" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/spinlock/">EVL Spinlock<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/kernel-api/timer/" title="Timer" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/timer/">Timer<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/kernel-api/xbuf/" title="Cross-buffer access" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/xbuf/">Cross-buffer access<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/kernel-api/interrupts/" title="Managing IRQs" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/interrupts/">Managing IRQs<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/core/kernel-api/stax/" title="Stage exclusion lock" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/kernel-api/stax/">Stage exclusion lock<i class="fas fa-check read-icon"></i></a><ul></ul></li></ul></li>
          <li data-nav-id="/core/under-the-hood/" title="Under the hood" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/core/under-the-hood/">&#9702; Under the hood<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/core/under-the-hood/abi/" title="The EVL ABI" class="dd-item"><a href="https://the-going.github.io/evlproject/core/under-the-hood/abi/">ABI revisions<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/core/abi-revs/" title="ABI revisions" class="dd-item"><a href="https://the-going.github.io/evlproject/core/abi-revs/">ABI revisions<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/dovetail/" title="Dovetail interface" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/">&#8226; Dovetail interface<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/dovetail/pipeline/" title="Interrupt pipeline" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/dovetail/pipeline/">&#9702; Interrupt pipeline<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/dovetail/pipeline/irq_handling/" title="IRQ handling" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/pipeline/irq_handling/">IRQ handling<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/pipeline/synthetic/" title="Synthetic IRQs" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/pipeline/synthetic/">Synthetic IRQs<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/pipeline/pipeline_inject/" title="IRQ injection" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/pipeline/pipeline_inject/">IRQ injection<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/pipeline/interrupt_protection/" title="Interrupt protection" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/pipeline/interrupt_protection/">Interrupt protection<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/pipeline/stage_push/" title="Installing the out-of-band stage" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/pipeline/stage_push/">OOB stage installation<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/pipeline/stage_escalation/" title="Stage escalation" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/pipeline/stage_escalation/">Stage escalation<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/pipeline/locking/" title="Locking" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/pipeline/locking/">Locking<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/dovetail/porting/" title="Porting Dovetail" class="dd-item alwaysopen"><a href="https://the-going.github.io/evlproject/dovetail/porting/">&#9702; Porting Dovetail<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/dovetail/porting/prerequisites/" title="Prerequisites" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/porting/prerequisites/">Prerequisites<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/porting/irqflow/" title="Interrupt flow" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/porting/irqflow/">Interrupt flow<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/porting/atomic/" title="Atomic operations" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/porting/atomic/">Atomic operations<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/porting/arch/" title="Architecture-specific bits" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/porting/arch/">Architecture bits<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/porting/timer/" title="Tick devices" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/porting/timer/">Tick devices<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/porting/clocksource/" title="Reading clock sources" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/porting/clocksource/">Clock sources<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/porting/syscall/" title="Syscall path" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/porting/syscall/">Syscall path<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/porting/rawprintk/" title="Raw printk support" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/porting/rawprintk/">Serial debugging<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/porting/misc/" title="Misc" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/porting/misc/">Misc<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/porting/devnotes/" title="Developer&#39;s Notes" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/porting/devnotes/">Developer&#39;s Notes<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/dovetail/altsched/" title="Alternate scheduling" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/altsched/">Alternate scheduling<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/files/" title="File tracking" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/files/">File tracking<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/sockets/" title="Socket handling" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/sockets/">Socket handling<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/dovetail/rulesofthumb/" title="Rules Of Thumb" class="dd-item"><a href="https://the-going.github.io/evlproject/dovetail/rulesofthumb/">Rules Of Thumb<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/ports/" title="Status of EVL ports" class="dd-item"><a href="https://the-going.github.io/evlproject/ports/">&#8226; Ports<i class="fas fa-check read-icon"></i></a><ul></ul></li>
          <li data-nav-id="/contributing/" title="Contributing to Xenomai 4" class="dd-item"><a href="https://the-going.github.io/evlproject/contributing/">&#8226; Contributing<i class="fas fa-check read-icon"></i></a><ul></ul></li>
        </ul>
        <div id="shortcuts">
          <div class="nav-title"></div>
          <ul>
            <li><a class="padding" href="https://the-going.github.io/evlproject/"><i class='fas fa-home'></i> Home</a></li>
            <li><a class="padding" href="https://riot.im/app/#/room/#evlproject:matrix.org/"><i class='fas fa-comments'></i> RIOT channel</a></li>
            <li><a class="padding" href="https://xenomai.org/mailman/listinfo/xenomai/"><i class='fas fa-comment-dots'></i> Mailing list</a></li>
          </ul>
        </div>
        <div id="prefooter">
          <hr/>
          <ul>
            <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
          </ul>
        </div>
        <div id="footer">

        </div>
      </div>
    </nav>
    <div id="body">
      <div id="overlay"></div>
      <div class="padding highlightable">
        <div id="top-bar">
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                <i class="fas fa-bars"></i>
              </a>
            </span>
            <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <meta itemprop="itemListOrder" content="Descending" />
                <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><meta itemprop="position" content="4" /><a itemprop="item" href="https://the-going.github.io/evlproject/"><span itemprop="name">Xenomai 4</span></a> > </li>
                <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><meta itemprop="position" content="3" /><a itemprop="item" href="https://the-going.github.io/evlproject/core/"><span itemprop="name">The EVL core</span></a> > </li>
                <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><meta itemprop="position" content="2" /><a itemprop="item" href="https://the-going.github.io/evlproject/core/user-api/"><span itemprop="name">Using libevl</span></a> > </li>
                <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><meta itemprop="position" content="1" /><a itemprop="item" href="https://the-going.github.io/evlproject/core/user-api/poll/" aria-disabled="true"><span itemprop="name">Polling file descriptors</span></a></li>
            </ol>
          </div>
            <div class="progress">
              <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#waiting-for-events-on-file-descriptors">Waiting for events on file descriptors</a></li>
        <li><a href="#polling-services">Polling services</a></li>
      </ul>
    </li>
  </ul>
</nav>
              </div>
            </div>
        </div>
        <div id="head-tags">
        </div>
        <main id="body-inner">
          <h1>Polling file descriptors</h1>

<h3 id="waiting-for-events-on-file-descriptors">Waiting for events on file descriptors</h3>
<p>Every <a href="https://the-going.github.io/evlproject/core/#evl-core-elements">EVL element</a>
is represented by a device file accessible in the <a href="https://the-going.github.io/evlproject/core/user-api/#evl-fs-hierarchy">/dev/evl</a> file hierarchy,
and requests can be sent to any of those elements by writing to common
file descriptors obtained on the corresponding files. Conversely,
information is returned to the caller by reading from those file
descriptors. EVL applications can poll for out-of-band events
occurring on a set of file descriptors opened on elements, just like
in-band applications can use
<a href="http://man7.org/linux/man-pages/man2/poll.2.html">poll(2)</a> with other
files.</p>
<p>To access the out-of-band polling services, an application first needs
to obtain a file descriptor on a new <em>polling set</em> by a call to
<a href="#evl_new_poll">evl_poll()</a>. Such descriptor is an
access point for registering other file descriptors to monitor, then
<a href="#evl_poll">sensing events</a> occurring on them.
<a href="#evl_poll">evl_poll()</a> or <a href="#evl_timedpoll">evl_timedpoll()</a> fill an array of structures indicating
which events have been received on each notified file descriptor. The
type of this structure is as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">struct evl_poll_event {
	int32_t fd;
	int32_t events;
};
</code></pre></div><p>Applications can wait for any event which
<a href="http://man7.org/linux/man-pages/man2/poll.2.html">poll(2)</a> can
monitor such as <code>POLLIN</code>, <code>POLLOUT</code>, <code>POLLRDNORM</code>, <code>POLLWRNORM</code> and so
on. Which event can occur on a given file descriptor is defined by the
out-of-band driver managing the file it refers to.</p>
<table style="width:10%; text-align: center;">
  <tr>
    <th>Pollable elements</th>
  </tr>
  <tr>
    <td><a href="https://the-going.github.io/evlproject/core/user-api/semaphore/index.html#sema4-poll-events" target="_blank">Semaphore</a></td>
  </tr>
  <tr>
    <td><a href="https://the-going.github.io/evlproject/core/user-api/flags/index.html#flags-poll-events" target="_blank">Event flag group</a></td>
  </tr>
  <tr>
    <td><a href="https://the-going.github.io/evlproject/core/user-api/timer/index.html#timer-poll-events" target="_blank">Timer</a></td>
  </tr>
  <tr>
    <td><a href="https://the-going.github.io/evlproject/core/user-api/proxy/index.html#proxy-poll-events" target="_blank">Proxy</a></td>
  </tr>
  <tr>
    <td><a href="https://the-going.github.io/evlproject/core/user-api/xbuf/index.html#xbuf-poll-events" target="_blank">Cross-buffer</a></td>
  </tr>
</table>
<h3 id="polling-services">Polling services</h3>

<div class="proto"><a name="evl_new_poll"></a>
int evl_new_poll(void)
</div>

<p>This call creates a polling set, returning a file descriptor
representing the new object upon success. There is no arbitrary limit
on the number of polling sets an application can create, which is only
limited to the available system resources.</p>
<p><code>evl_new_poll()</code> returns the file descriptor of the newly created
polling set on success. Otherwise, a negated error code is returned:</p>
<ul>
<li>
<p>-EMFILE	The per-process limit on the number of open file descriptors
has been reached.</p>
</li>
<li>
<p>-ENFILE	The system-wide limit on the total number of open files
has been reached.</p>
</li>
<li>
<p>-ENOMEM	No memory available.</p>
</li>
<li>
<p>-ENXIO	The EVL library is not initialized for the current process.
Such initialization happens implicitly when
<a href="https://the-going.github.io/evlproject/core/user-api/thread/#evl_attach_self">evl_attach_self()</a>
is called by any thread of your process, or by
explicitly calling <a href="https://the-going.github.io/evlproject/core/user-api/init/#evl_init">evl_init()</a>. You have
to bootstrap the library services in a way or another
before creating an EVL polling set.</p>
</li>
</ul>
<hr>

<div class="proto"><a name="evl_add_pollfd"></a>
int evl_add_pollfd(int efd, int newfd, unsigned int events)
</div>

<p>Adds a file descriptor to a polling set. This service registers the
<em>newfd</em> file descriptor for being polled for <em>events</em> by the <em>efd</em>
polling set.</p>

<p><li><i>efd</i><p>The file descriptor of a polling set obtained by a previous call to
<a href="#evl_new_poll">evl_new_poll()</a>.</p>
</li></p>


<p><li><i>newfd</i><p>A file descriptor to monitor for events. Once <em>newfd</em> is added to the
polling set, it becomes a source of events which is monitored when
reading from <em>efd</em>. You can add as many file descriptor as you need to
a polling set in order to perform synchronous I/O multiplexing over
multiple data sources or sinks.</p>
</li></p>


<p><li><i>events</i><p>A bitmask representing the set of events to monitor for <em>newfd</em>. These
events are common to the in-band
<a href="http://man7.org/linux/man-pages/man2/poll.2.html">poll(2)</a>
interface. <code>POLLERR</code> and <code>POLLHUP</code> are always implicitly polled, even
if they are not mentioned in <em>events</em>. <code>POLLNVAL</code> cannot be awaited
for. Which event is meaningful in the context of the call depends on
the driver managing the file, which defines the logic for raising
them.  For instance, if <em>newfd</em> refers to an <a href="https://the-going.github.io/evlproject/core/user-api/semaphore/#sema4-poll-events">EVL semaphore</a>, you
could monitor <code>POLLIN</code> and <code>POLLRDNORM</code>, no other event would occur
for this type of file.</p>
</li></p>

<p><code>evl_add_pollfd()</code> returns zero on success. Otherwise, a negated error
code is returned:</p>
<ul>
<li>
<p>-EBADF	 <em>efd</em> is not a valid file descriptor referring to an EVL
polling set.</p>
</li>
<li>
<p>-EBADF	 <em>newfd</em> is not a valid file descriptor to an EVL file. Note
that you cannot register a file descriptor referring to a
common file (i.e. managed by an in-band driver) into an
EVL polling set. An EVL file is created by [out-of-band drivers]
(/core/user-api/io/) for referring
to resources which can be accessed from the [out-of-band execution]
(/dovetail/altsched/) stage.</p>
</li>
<li>
<p>-ELOOP	 Adding <em>newfd</em> to the polling set would lead to a cyclic
dependency (such as <em>newfd</em> referring to the polling set).</p>
</li>
<li>
<p>-ENOMEM	 No memory available.</p>
</li>
</ul>
<hr>

<div class="proto"><a name="evl_del_pollfd"></a>
int evl_del_pollfd(int efd, int delfd)
</div>

<p>Removes a file descriptor from a polling set. As a result, reading
this polling set does not monitor <em>delfd</em> anymore. This change applies
to subsequent calls to <a href="#evl_poll">evl_poll()</a> or
<a href="#evl_timedpoll">evl_timedpoll()</a> for such set;
ongoing waits are not affected.</p>

<p><li><i>efd</i><p>The file descriptor of a polling set obtained by a previous call to
<a href="#evl_new_poll">evl_new_poll()</a>.</p>
</li></p>


<p><li><i>delfd</i><p>The file descriptor to stop monitoring for events. This descriptor
should have been registered by an earlier call to
<a href="#evl_add_pollfd">evl_add_pollfd()</a>.</p>
</li></p>

<p><code>evl_del_pollfd()</code> returns zero on success. Otherwise, a negated error
code is returned:</p>
<ul>
<li>
<p>-EBADF	 <em>efd</em> is not a valid file descriptor referring to an EVL
polling set.</p>
</li>
<li>
<p>-ENOENT	 <em>delfd</em> is not a file descriptor present into the polling
set referred to by <em>efd</em>.</p>
</li>
</ul>
<hr>

<div class="proto"><a name="evl_mod_pollfd"></a>
int evl_mod_pollfd(int efd, int modfd, unsigned int events)
</div>

<p>Modifies the <em>events</em> being monitored for a file descriptor already
registered in a polling set. This change applies to subsequent calls
to <a href="#evl_poll">evl_poll()</a> or <a href="#evl_timedpoll">evl_timedpoll()</a> for such set; ongoing waits are not
affected.</p>

<p><li><i>efd</i><p>The file descriptor of a polling set obtained by a previous call to
<a href="#evl_new_poll">evl_new_poll()</a>.</p>
</li></p>


<p><li><i>modfd</i><p>The file descriptor to update the event mask for. This descriptor
should have been registered by an earlier call to
<a href="#evl_add_pollfd">evl_add_pollfd()</a>.</p>
</li></p>

<p><code>evl_mod_pollfd()</code> returns zero on success. Otherwise, a negated error
code is returned:</p>
<ul>
<li>
<p>-EBADF	 <em>efd</em> is not a valid file descriptor referring to an EVL
polling set.</p>
</li>
<li>
<p>-ENOENT	 <em>pollfd</em> is not a file descriptor present into the polling
set referred to by <em>efd</em>.</p>
</li>
</ul>
<hr>

<div class="proto"><a name="evl_poll"></a>
int evl_poll(int efd, struct evl_poll_event *pollset, int nrset)
</div>

<p>Waits for events on the file descriptors present in the polling set
referred to by <em>efd</em>.</p>

<p><li><i>efd</i><p>The file descriptor of a polling set obtained by a previous call to
<a href="#evl_new_poll">evl_new_poll()</a>.</p>
</li></p>


<p><li><i>pollset</i><p>The start of an array of structures of type <code>evl_poll_event</code>
containing the set of file descriptors which have received at least
one event when the call returns.</p>
</li></p>


<p><li><i>nrset</i><p>The number of structures in the <em>pollset</em> array. If zero,
<a href="#evl_new_poll">evl_poll()</a> returns immediately with
a zero count.</p>
</li></p>

<p>On success, <code>evl_poll()</code> returns the count of file descriptors from
the polling set for which an event is pending, each of them will
appear in a <code>evl_poll_event</code> entry in <em>pollset</em>. Otherwise, a negated
error code is returned:</p>
<ul>
<li>
<p>-EBADF	 <em>efd</em> is not a valid file descriptor referring to an EVL
polling set.</p>
</li>
<li>
<p>-EINVAL	 <em>nrset</em> is negative.</p>
</li>
<li>
<p>-EAGAIN	<em>fd</em> is marked as [non-blocking (O_NONBLOCK)]
(<a href="http://man7.org/linux/man-pages/man2/fcntl.2.html),">http://man7.org/linux/man-pages/man2/fcntl.2.html),</a> and no
file descriptor from the polling set has any event pending.</p>
</li>
<li>
<p>-EFAULT	 <em>pollset</em> points to invalid memory.</p>
</li>
</ul>
<hr>

<div class="proto"><a name="evl_timedpoll"></a>
int evl_timedpoll(int efd, struct evl_poll_event *pollset, int nrset, struct timespec *timeout)
</div>

<p>This call is a variant of <a href="#evl_poll">evl_poll()</a>
which allows specifying a timeout on the polling operation, so that
the caller is unblocked after a specified delay sleeping without
receiving any event.</p>

<p><li><i>efd</i><p>The file descriptor of a polling set obtained by a previous call to
<a href="#evl_new_poll">evl_new_poll()</a>.</p>
</li></p>


<p><li><i>pollset</i><p>The start of an array of structures of type <code>evl_poll_event</code>
containing the set of file descriptors which have received at least
one event when the call returns.</p>
</li></p>


<p><li><i>nrset</i><p>The number of structures in the <em>pollset</em> array. If zero,
<a href="#evl_new_poll">evl_poll()</a> returns immediately with
a zero count.</p>
</li></p>


<p><li><i>timeout</i><p>A time limit to wait for any event to be notified before the call
returns on error. Timeouts are always based on the built-in
<a href="https://the-going.github.io/evlproject/core/user-api/clock/#builtin-clocks">EVL_CLOCK_MONOTONIC</a> clock. If both the
<code>tv_sec</code> and <code>tv_nsec</code> members of <em>timeout</em> are set to zero,
<a href="#evl_timedpoll">evl_timedpoll()</a> behaves identically
to <a href="#evl_poll">evl_poll()</a>.</p>
</li></p>

<p>On success, <code>evl_timedpoll()</code> returns the count of file descriptors
from the polling set for which an event is pending, each of them will
appear in a <code>evl_poll_event</code> entry in <em>pollset</em>. Otherwise, a negated
error code is returned:</p>
<ul>
<li>
<p>-EBADF	 <em>efd</em> is not a valid file descriptor referring to an EVL
polling set.</p>
</li>
<li>
<p>-EINVAL	 <em>nrset</em> is negative.</p>
</li>
<li>
<p>-EFAULT	 <em>pollset</em> or <em>timeout</em> point to invalid memory.</p>
</li>
<li>
<p>-EINVAL	 any of <code>tv_sec</code> or <code>tv_nsec</code> in <em>timeout</em> is invalid.</p>
</li>
<li>
<p>-ETIMEDOUT	 The timeout fired, after the amount of time specified by
<em>timeout</em>.</p>
</li>
</ul>
<hr>
<p style="text-align:right">Last modified: Sun, 03 May 2020 11:13:49 &#43;0200</p>


          <footer class=" footline">
          </footer>
        </main>
      </div>
      <div id="navigation">
        <a class="nav nav-prev" href="https://the-going.github.io/evlproject/core/user-api/proxy/" title="File proxy"><i class="fa fa-chevron-left"></i></a>
        <a class="nav nav-next" href="https://the-going.github.io/evlproject/core/user-api/io/" title="Out-of-band I/O services"><i class="fa fa-chevron-right"></i></a>
      </div>
    </div>
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://the-going.github.io/evlproject/js/clipboard.min.js?1634415569"></script>
    <script src="https://the-going.github.io/evlproject/js/perfect-scrollbar.min.js?1634415569"></script>
    <script src="https://the-going.github.io/evlproject/js/perfect-scrollbar.jquery.min.js?1634415569"></script>
    <script src="https://the-going.github.io/evlproject/js/jquery.svg.pan.zoom.js?1634415569"></script>
    <script src="https://the-going.github.io/evlproject/js/featherlight.min.js?1634415569"></script>
    <script src="https://the-going.github.io/evlproject/js/modernizr.custom-3.6.0.js?1634415569"></script>
    <script src="https://the-going.github.io/evlproject/js/mermaid.min.js?1634415569"></script>
    <script>
      if (typeof mermaid != 'undefined') {
        mermaid.mermaidAPI.initialize( Object.assign( { "securityLevel": "antiscript" }, JSON.parse("{ \"startOnLoad\": true }"), { startOnLoad: false } ) );
      }
    </script>
    <script src="https://the-going.github.io/evlproject/js/relearn.js?1634415569"></script>
  </body>
</html>
